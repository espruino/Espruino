ªp(c,h){ªd(f){Ñram;f.idž(l[f.id]=f);f.type (f.type="");f.cžf.c.forEach(d)}¯._l=¯.l=c;¯.options=h {};¯.lazy=¯.options.lazy !Ô;¯.physBtns=Ô;­e;£(ÔŒprocess.env.HWVERSION){¯.physBtns=Ô;e=[];ªf(b){Ñram;ÑbtnŠb.typeže.push(b);b.cžb.c.forEach(f)}f(c);e.lengthž(¯.physBtns=Ó,¯.buttons=e,¯.selectedButton=Ôÿ)}£(¯.options.btns)£(c=¯.options.btns,¯.physBtns‘c.length){¯.b=c;­f=Math.floor(Bangle.appRect.h/¯.physBtns);§(Ô<¯.physBtnsžÔŠc.lengthžc.unshift({label:""});¯.physBtns>c.length;)c.push({label:""});¯._l.width=g.getWidth()-Ô;¯._l={type:Ñh,filly:Ô,c:[¯._l,{type:Ñv,pad:Ô,filly:Ô,c:c.map(b¢(b.type=Ñtxt,b.font=Ñ6x8,b.height=f,b.r=Ô,b))}]}}¤¯._l.width=g.getWidth()-Ô ,¯._l={type:Ñh,c:[¯._l,{type:Ñv,c:c.map(f¢(f.type=Ñbtn,f.filly=Ô,f.width=Ô ,f.r=Ô,f))}]},eže.push.apply(e,¯._l.c[Ô].c);¯.setUI();¬l=¯;d(¯._l);¯.updateNeeded=!Ó}ªt(c,h,d,e,l){¬f=¶Šc.bgCol?l:g.toColor(c.bgCol);£(fŒl ÑtxtŠc.type ÑbtnŠc.type ÑimgŠc.type ÑcustomŠc.type){¬b=c.c;¾c.c;¬k=ÑH+E.CRC32(E.toJS(c));bž(c.c=b);¾h[k] ((e[k]=[c.x,c.y,c.x+c.w-Ô,c.y+c.h-Ô]).bg=¶Šl?g.theme.bg:l,dž(d.push(c),d=¶))}£(c.c)§(¬aÆc.c)t(a,h,d,e,f)}p.prototype.setUI=ª(){Bangle.setUI();­c;¯.buttonsž(Bangle.setUI({mode:Ñupdown,back:¯.options.back,remove:¯.options.remove},h¢{¬d=¯.selectedButton,e=¯.buttons.length;£(ÀÓ‹hž¯.buttons[d])«¯.buttons[d].cb();¯.buttons[d]ž(¾¯.buttons[d].selected,¯.render(¯.buttons[d]));d=(d+e+h)%e;¯.buttons[d]ž(¯.buttons[d].selected=Ô,¯.render(¯.buttons[d]));¯.selectedButton=d}),c=!Ó);!¯.options.backž!¯.options.remove c Bangle.setUI({mode:Ñcustom,back:¯.options.back,remove:¯.options.remove});£(¯.b){ªh(d,e){.75<e.time-e.lastTimež¯.b[d].cbl?¯.b[d].cbl(e):¯.b[d].cbž¯.b[d].cb(e)}Bangle.btnWatchesžBangle.btnWatches.forEach(clearWatch);Bangle.btnWatches=[];¯.b[Ó]žBangle.btnWatches.push(setWatch(h.bind(¯,Ó),BTN1,{repeat:!Ó,edge:Ôÿ}));¯.b[Ô]žBangle.btnWatches.push(setWatch(h.bind(¯,Ô),BTN2,{repeat:!Ó,edge:Ôÿ}));¯.b[Ô]žBangle.btnWatches.push(setWatch(h.bind(¯,Ô),BTN3,{repeat:!Ó,edge:Ôÿ}))}£(ÔŠprocess.env.HWVERSION){ªh(d,e){d.cbže.x‘d.xže.y‘d.yže.xŽd.x+d.wže.yŽd.y+d.hž(ÔŠe.typežd.cbl?d.cbl(e):d.cbžd.cb(e));d.cžd.c.forEach(l¢h(l,e))}Bangle.touchHandler=(d,e)¢h(¯._l,e);Bangle.on(Ñtouch,Bangle.touchHandler)}};p.prototype.render=ª(c){ªh(a){Ñram;d.reset();ÀÓa.colžd.setColor(a.col);ÀÓa.bgColžd.setBgColor(a.bgCol).clearRect(a.x,a.y,a.x+a.w-Ô,a.y+a.h-Ô);e[a.type](a)}c (c=¯._l);¯.updateNeededž¯.update();¬d=g,e={"":ª(){},txt:ª(a){Ñram;£(a.wrap){¬m=d.setFont(a.font).setFontAlign(Ó,Ôÿ).wrapString(a.label,a.w),n=a.y+(a.h-d.getFontHeight()*m.length’Ô);d.drawString(m.join(Ñ
),a.x+(a.w’Ô),n)}¤d.setFont(a.font).setFontAlign(Ó,Ó,a.r).drawString(a.label,a.x+(a.w’Ô),a.y+(a.h’Ô))},btn:ª(a){Ñram;¬m=a.x+(Ó|a.pad),n=a.y+(Ó|a.pad),q=a.w-(a.padÔ),r=a.h-(a.padÔ);m=[m,n+Ô,m+Ô,n,m+q-Ô,n,m+q-Ô,n+Ô,m+q-Ô,n+r-Ô,m+q-Ô,n+r-Ô,m+Ô,n+r-Ô,m,n+r-Ô,m,n+Ô];n=ÀÓa.btnBorderCol?a.btnBorderCol:d.theme.fg2;q=ÀÓa.btnFaceCol?a.btnFaceCol:d.theme.bg2;a.selectedž(q=d.theme.bgH,n=d.theme.fgH);d.setColor(q).fillPoly(m).setColor(n).drawPoly(m);ÀÓa.colžd.setColor(a.col);a.src?d.setBgColor(q).drawImage(ÑfunctionŠ¿a.src?a.src():a.src,a.x+a.w/Ô,a.y+a.h/Ô,{scale:a.scale ÀÓ,rotate:.5*Math.PI*(a.r Ó)}):d.setFont(a.font Ñ6x8:2).setFontAlign(Ó,Ó,a.r).drawString(a.label,a.x+a.w/Ô,a.y+a.h/Ô)},img:ª(a){Ñram;d.drawImage(ÑfunctionŠ¿a.src?a.src():a.src,a.x+a.w/Ô,a.y+a.h/Ô,{scale:a.scale ÀÓ,rotate:.5*Math.PI*(a.r Ó)})},custom:ª(a){Ñram;a.render(a)},h:ª(a){Ñram;a.c.forEach(h)},v:ª(a){Ñram;a.c.forEach(h)}};£(¯.lazy){¯.rects (¯.rects={});¬l=¯.rects.clone(),f=[];t(c,l,f,¯.rects,¶);§(¬b¹l)¾¯.rects[b];c=Object.keys(l).map(a¢l[a]).reverse();§(¬kÆc)d.setBgColor(k.bg).clearRect.apply(g,k);f.forEach(h)}¤h(c)};p.prototype.forgetLazyState=ª(){¯.rects={}};p.prototype.layout=ª(c){¬h=Math.floor,d={h:ª(e){Ñram;¬l=e.x+(Ó|e.pad),f=Ó,b=e.cže.c.reduce((a,m)¢a+(Ó|m.fillx),Ó);b (l–e.w-e._w’Ô,b=Ô);¬k=l;e.c.forEach(a¢{a.x=Ó|k;l–a._w;f–Ó|a.fillx;k=l+h(f*(e.w-e._w)/b);a.w=Ó|k-a.x;a.h=Ó|(a.filly?e.h-(e.padÔ):a._h);a.y=Ó|e.y+(Ó|e.pad)+((Ô+(Ó|a.valign))*(e.h-(e.padÔ)-a.h)’Ô);£(a.c)d[a.type](a)})},v:ª(e){Ñram;¬l=e.y+(Ó|e.pad),f=Ó,b=e.cže.c.reduce((a,m)¢a+(Ó|m.filly),Ó);b (l–e.h-e._h’Ô,b=Ô);¬k=l;e.c.forEach(a¢{a.y=Ó|k;l–a._h;f–Ó|a.filly;k=l+h(f*(e.h-e._h)/b);a.h=Ó|k-a.y;a.w=Ó|(a.fillx?e.w-(e.padÔ):a._w);a.x=Ó|e.x+(Ó|e.pad)+((Ô+(Ó|a.halign))*(e.w-(e.padÔ)-a.w)’Ô);£(a.c)d[a.type](a)})}};£(d[c.type])d[c.type](c)};p.prototype.debug=
ª(c,h){c (c=¯._l);h=h Ô;g.setColor(h&Ô,h&Ô,h&Ô).drawRect(c.x+h-Ô,c.y+h-Ô,c.x+c.w-h,c.y+c.h-h);c.padžg.drawRect(c.x+c.pad-Ô,c.y+c.pad-Ô,c.x+c.w-c.pad,c.y+c.h-c.pad);h˜;c.cžc.c.forEach(d¢¯.debug(d,h))};p.prototype.update=ª(){ªc(b){Ñram;l[b.type](b);£(b.r&Ô){¬k=b._w;b._w=b._h;b._h=k}b._w=d(b._w+(b.padÔ),Ó|b.width);b._h=d(b._h+(b.padÔ),Ó|b.height)}¾¯.updateNeeded;¬h=g,d=Math.max,e=Math.round,l={txt:ª(b){Ñram;b.font.endsWith(Ñ%)ž(b.font=ÑVector+e(h.getHeight()*b.font.slice(Ó,Ôÿ)/Ôd));£(b.wrap)b._h=b._w=Ó;¤{¬k=h.setFont(b.font).stringMetrics(b.label);b._w=k.width;b._h=k.height}},btn:ª(b){Ñram;b.fontžb.font.endsWith(Ñ%)ž(b.font=ÑVector+e(h.getHeight()*b.font.slice(Ó,Ôÿ)/Ôd));¬k=b.src?h.imageMetrics(ÑfunctionŠ¿b.src?b.src():b.src):h.setFont(b.font Ñ6x8:2).stringMetrics(b.label);b._h=Ô+k.height;b._w=Ô+k.width},img:ª(b){Ñram;¬k=h.imageMetrics(ÑfunctionŠ¿b.src?b.src():b.src),a=b.scale Ô;b._w=k.width*a;b._h=k.height*a},"":ª(b){Ñram;b._w=Ó;b._h=Ó},custom:ª(b){Ñram;b._w=Ó;b._h=Ó},h:ª(b){Ñram;b.c.forEach(c);b._h=b.c.reduce((k,a)¢d(k,a._h),Ó);b._w=b.c.reduce((k,a)¢k+a._w,Ó);¶Šb.fillxžb.c.some(k¢k.fillx)ž(b.fillx=Ô);¶Šb.fillyžb.c.some(k¢k.filly)ž(b.filly=Ô)},v:ª(b){Ñram;b.c.forEach(c);b._h=b.c.reduce((k,a)¢k+a._h,Ó);b._w=b.c.reduce((k,a)¢d(k,a._w),Ó);¶Šb.fillxžb.c.some(k¢k.fillx)ž(b.fillx=Ô);¶Šb.fillyžb.c.some(k¢k.filly)ž(b.filly=Ô)}},f=¯._l;c(f);¾l;f.fillx f.filly?(f.w=Bangle.appRect.w,f.h=Bangle.appRect.h,f.x=Bangle.appRect.x,f.y=Bangle.appRect.y):(f.w=f._w,f.h=f._h,f.x=Bangle.appRect.w-f.w’Ô,f.y=Bangle.appRect.y+(Bangle.appRect.h-f.h’Ô));¯.layout(f)};p.prototype.clear=ª(c){c (c=¯._l);g.reset();ÀÓc.bgColžg.setBgColor(c.bgCol);g.clearRect(c.x,c.y,c.x+c.w-Ô,c.y+c.h-Ô)};exports=p